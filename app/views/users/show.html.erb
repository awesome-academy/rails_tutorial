<% provide :title, t("users_show.microposts.title", count: @pagy.count) %>

<div class="row">
  <aside class="col-md-4">
    <section class="user_info mb-3">
      <%= gravatar_for @user, size: 80 %>
      <h1><%= @user.name %></h1>
      <%= link_to t("users_show.view_profile"),
                  @user,
                  class: "btn btn-outline-primary btn-sm" %>
    </section>
    <section class="stats mb-3">
      <%= link_to following_path(@user) do %>
        <strong id="following" class="stat">
          <%= @user.following.count %>
        </strong>
        <%= t("users_show.stats.following") %>
      <% end %>
      <%= link_to followers_path(@user) do %>
        <strong id="followers" class="stat">
          <%= @user.followers.count %>
        </strong>
        <%= t("users_show.stats.followers") %>
      <% end %>
    </section>

    <% if logged_in? && current_user?(@user) %>
      <section class="micropost_form mb-3">
        <%= render 'microposts/form', micropost: @micropost %>
      </section>
    <% end %>
  </aside>

  <div class="col-md-8">
  <%= render "follow_form", user: @user if logged_in? && current_user != @user %>

    <h3>
      <%= t("users_show.microposts.title", count: @pagy.count) %>
    </h3>

    <% if @microposts.any? %>
      <%= render @microposts %>
      <div class="d-flex justify-content-center mt-3">
        <%= pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
      </div>
    <% else %>
      <p>
        <% key = current_user?(@user) ?
            "users_show.microposts.no_posts_current" :
            "users_show.microposts.no_posts_other" %>
        <%= t(key) %>
      </p>
<% end %>
  </div>
</div>
